plugins {
    id 'groovy'
    id 'codenarc'
    id 'com.gradle.plugin-publish' version '0.14.0'
    id 'java-gradle-plugin'
    id "maven-publish"
    id "signing"
}

sourceCompatibility = 1.8

dependencies {
    implementation gradleApi()
    implementation 'net.sf.saxon:Saxon-HE:10.5'
    implementation 'xml-resolver:xml-resolver:1.2'

    testImplementation('org.spockframework:spock-core:1.3-groovy-2.5') {
        exclude group: 'org.codehaus.groovy'
    }

    testImplementation gradleTestKit()
}

repositories {
    mavenCentral()
}

group = 'com.nwalsh'
version = '0.9.1-beta1'

test {
    testLogging {
        showStandardStreams = true
        exceptionFormat = 'full'
    }
}

wrapper {
    gradleVersion = '7.0'
}

codenarc {
    toolVersion = '2.1.0'
    configFile = file('config/codenarc/codenarc.groovy')
}

pluginBundle {
    website = 'https://github.com/ndw/saxon-gradle'
    vcsUrl = 'https://github.com/ndw/saxon-gradle.git'
    description = 'A Gradle plugin for running Saxon'
    tags = ['saxon', 'xslt', 'documentation']
}

gradlePlugin {
    plugins {
        SaxonPlugin {
            id = 'com.nwalsh.saxon-gradle'
            displayName = 'Saxon Gradle Plugin'
            implementationClass = 'com.nwalsh.SaxonPlugin'
            description = 'A Gradle plugin for running XSLT transformations with Saxon'
        }
    }
}

publishPlugins.dependsOn check
